GDSC STUDY_전혜승
기간: 9주차(2023.07.08~2023.07.20)

1. 스터디 주제
   쿠버네티스 공부하기

2. 스터디 내용
## 고가용성과 내결함성

---

**고가용성(HA : High Availability**) 이란, 서버와 네트워크 또는 프로그램 등의 정보 시스템이 상당히 오랜 기간 동안 지속적으로 장애 없이 정상적으로 사용 가능한 성질을 의미한다.

**내결함성(FT: Fault Tolerance)**이란 시스템의 일부 구성 요소가 작동하지 않더라도 계속 작동할 수 있는 기능을 의미한다.

그렇다면 이 두 가지를 고려했을 때, 쿠버네티스가 여러 개의 노드를 띄우고 그 안의 파드에서 서비스를 실행하는 이유는 무엇일까? 만약 하나의 노드가 죽어서 그 안의 파드 또한 서비스가 되지 않는다면 kubelet과 kube-schedualer가 파드를 다른 노드로 옮길 수 있다. 이 경우에는 계속해서 가용할 수 있기 때문에 고가용성은 보장되지만, 내결함성은 보장되지 않는다. 파드를 옮기는 시간 동안은 작동하지 않기 때문이다.

따라서 이를 해결하기 위해서 동시에 두 개의 노드에서 두 파드를 띄워놓는 방식으로 해결한다. 이 경우에는 고가용성과 내결함성이 둘 다 보장된다.

## 쿠버네티스의 비효율성

---

쿠버네티스의 노드는 하나의 서버라고 생각하면 된다. 따라서 각 노드마다 모니터링이 필요하다. 즉, 직접 서버를 쓸 경우에는 각 서버에 하나만 모니터링 솔루션을 설치하면 되지만, 쿠버네티스를 쓰는 경우에는 모든 노드에 다 모니터링 솔루션을 설치해야 하기 때문에 리소스를 낭비할 수 있다.

또한, 쿠버네티스는 최소 마스터 노드 1개 - 워커 노드 2개라는 구성을 사용해야 한다. 따라서 서비스의 규모가 일정 수준 이하일 경우에는 굉장히 비효율적인 방법이 될 수 있다. 이러한 이유로 쿠버네티스는 대규모 서비스에서 주로 사용된다.

## Static Pod를 쓰는 이유

---

3개의 워커 노드에 파드를 3개 띄운다고 해도, 쿠버네티스가 자동으로 노드를 할당해주기 때문에 반드시 각 노드마다 파드가 하나씩 할당되지 않는다. 그런데 만약 노드 모니터링을 하고 싶다고 하자. 이 경우에는 노드에 랜덤으로 파드가 할당되면 안 된다. 따라서 어떤 워커 노드에 하나의 파드가 반드시 필수적으로 보장되어야 할 때 static pod를 통해서 이를 보장해줄 수 있다. 왜냐하면 kubelet이 직접 실행하는 파드이기 때문에 파드들을 삭제할 때 apiserver를 통해 설치되지 않은 static pod는 삭제 불가능하다.

이때 워커 노드에만 yaml을 설치하면 하나의 워커 노드에 한해서만 static pod가 만들어지므로, 마스터 노드에 yaml을 설치해야 각 워커 노드에 하나씩 파드가 뜨는 것을 보장해줄 수 있다.

각 노드에 하나씩 파드가 반드시 뜨도록 하는 전략들:

- label
- 데몬 셋
- static pod